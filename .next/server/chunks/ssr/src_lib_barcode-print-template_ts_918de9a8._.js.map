{"version":3,"sources":["turbopack:///[project]/src/lib/barcode-print-template.ts"],"sourcesContent":["/**\r\n * Unified barcode print template for consistent single and bulk printing\r\n */\r\n\r\nexport interface BarcodeData {\r\n  barcode: string\r\n  productName?: string\r\n  price?: number\r\n}\r\n\r\nexport const generatePrintHTML = (\r\n  barcodes: BarcodeData[],\r\n  printerSize: '58mm' | '80mm',\r\n  formatPrice: (price: number) => string\r\n): string => {\r\n  const barcodeHTML = barcodes.map(item => `\r\n    <div class=\"barcode-label\">\r\n      ${item.productName ? `<div class=\"product-name\">${item.productName.toUpperCase()}</div>` : ''}\r\n      <div class=\"barcode-image\">\r\n        <canvas class=\"barcode-canvas\" data-barcode=\"${item.barcode}\"></canvas>\r\n      </div>\r\n      <div class=\"barcode-number\">${item.barcode}</div>\r\n      ${item.price ? `<div class=\"price\">${formatPrice(item.price)}</div>` : ''}\r\n    </div>\r\n  `).join('')\r\n\r\n  return `\r\n    <!DOCTYPE html>\r\n    <html>\r\n    <head>\r\n      <title>Print Barcodes</title>\r\n      <script src=\"https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js\"></script>\r\n      <style>\r\n        * {\r\n          margin: 0;\r\n          padding: 0;\r\n          box-sizing: border-box;\r\n        }\r\n        \r\n        /* Thermal printer specific CSS */\r\n        @media print {\r\n          @page {\r\n            size: ${printerSize === '58mm' ? '58mm auto' : '80mm auto'};\r\n            margin: 0;\r\n          }\r\n          \r\n          body {\r\n            margin: 0 !important;\r\n            padding: 2mm !important;\r\n          }\r\n          \r\n          .barcode-container {\r\n            width: 100% !important;\r\n          }\r\n        }\r\n        \r\n        body { \r\n          font-family: Arial, sans-serif; \r\n          margin: 0;\r\n          padding: 3mm;\r\n          background: white;\r\n          -webkit-print-color-adjust: exact;\r\n          print-color-adjust: exact;\r\n        }\r\n        \r\n\r\n        \r\n        .barcode-container {\r\n          display: flex;\r\n          flex-wrap: wrap;\r\n          gap: 1mm;\r\n          justify-content: ${barcodes.length === 1 ? 'center' : 'flex-start'};\r\n          align-items: flex-start;\r\n        }\r\n        \r\n        .barcode-label {\r\n          width: ${printerSize === '58mm' ? '54mm' : '76mm'};\r\n          height: ${printerSize === '58mm' ? '24mm' : '28mm'};\r\n          padding: 0.5mm;\r\n          display: flex;\r\n          flex-direction: column;\r\n          justify-content: center;\r\n          align-items: center;\r\n          page-break-inside: avoid;\r\n          break-inside: avoid;\r\n          background: white;\r\n          box-sizing: border-box;\r\n          border: 1px solid #ddd;\r\n          position: relative;\r\n          gap: 0;\r\n          margin-bottom: 1mm;\r\n        }\r\n        \r\n        .product-name {\r\n          font-size: ${printerSize === '58mm' ? '5pt' : '7pt'} !important;\r\n          font-weight: bold !important;\r\n          text-align: center !important;\r\n          line-height: 0.8 !important;\r\n          height: ${printerSize === '58mm' ? '3mm' : '4mm'};\r\n          overflow: hidden;\r\n          display: flex !important;\r\n          align-items: center !important;\r\n          justify-content: center !important;\r\n          word-wrap: break-word;\r\n          hyphens: auto;\r\n          color: #000 !important;\r\n          text-transform: uppercase;\r\n          margin: 0 !important;\r\n          padding: 0 !important;\r\n        }\r\n        \r\n        .barcode-image {\r\n          display: flex !important;\r\n          align-items: center !important;\r\n          justify-content: center !important;\r\n          margin: 0 !important;\r\n          padding: 0 !important;\r\n        }\r\n        \r\n        .barcode-canvas {\r\n          max-width: 100% !important;\r\n          height: ${printerSize === '58mm' ? '15px' : '20px'} !important;\r\n          display: block !important;\r\n          margin: 0 !important;\r\n          padding: 0 !important;\r\n        }\r\n        \r\n        .barcode-number {\r\n          font-size: ${printerSize === '58mm' ? '7pt' : '10pt'} !important;\r\n          font-weight: bold !important;\r\n          letter-spacing: 1px !important;\r\n          margin: 0 !important;\r\n          padding: 0 !important;\r\n          color: #000 !important;\r\n          font-family: 'Courier New', monospace !important;\r\n        }\r\n        \r\n        .price {\r\n          font-size: ${printerSize === '58mm' ? '9pt' : '12pt'} !important;\r\n          font-weight: bold !important;\r\n          color: #000 !important;\r\n          margin: 0 !important;\r\n          padding: 0 !important;\r\n        }\r\n        \r\n        @media print {\r\n          body { \r\n            margin: 0 !important; \r\n            padding: 2mm !important;\r\n            -webkit-print-color-adjust: exact !important;\r\n            print-color-adjust: exact !important;\r\n          }\r\n          \r\n          .barcode-container {\r\n            gap: 0 !important;\r\n          }\r\n          \r\n          .barcode-label { \r\n            margin: 0 !important;\r\n            margin-bottom: 0.5mm !important;\r\n            page-break-inside: avoid !important;\r\n            break-inside: avoid !important;\r\n            border: none !important;\r\n            orphans: 1;\r\n            widows: 1;\r\n          }\r\n          \r\n          .product-name {\r\n            font-size: ${printerSize === '58mm' ? '5pt' : '7pt'} !important;\r\n            color: #000 !important;\r\n            margin: 0 !important;\r\n            padding: 0 !important;\r\n          }\r\n          \r\n          .barcode-image {\r\n            margin: 0 !important;\r\n            padding: 0 !important;\r\n          }\r\n          \r\n          .barcode-number {\r\n            font-size: ${printerSize === '58mm' ? '7pt' : '10pt'} !important;\r\n            color: #000 !important;\r\n            margin: 0 !important;\r\n            padding: 0 !important;\r\n          }\r\n          \r\n          .price {\r\n            font-size: ${printerSize === '58mm' ? '9pt' : '12pt'} !important;\r\n            color: #000 !important;\r\n            margin: 0 !important;\r\n            padding: 0 !important;\r\n          }\r\n        }\r\n      </style>\r\n    </head>\r\n    <body>\r\n      <div class=\"barcode-container\">\r\n        ${barcodeHTML}\r\n      </div>\r\n      \r\n      <script>\r\n        // Generate barcodes first\r\n        function generateBarcodes() {\r\n          const canvases = document.querySelectorAll('.barcode-canvas');\r\n          canvases.forEach(canvas => {\r\n            const barcode = canvas.getAttribute('data-barcode');\r\n            if (barcode && window.JsBarcode) {\r\n              JsBarcode(canvas, barcode, {\r\n                format: 'CODE128',\r\n                width: ${printerSize === '58mm' ? '1.0' : '1.5'},\r\n                height: ${printerSize === '58mm' ? '15' : '20'},\r\n                displayValue: false,\r\n                margin: 0,\r\n                background: '#ffffff',\r\n                lineColor: '#000000'\r\n              });\r\n            }\r\n          });\r\n        }\r\n        \r\n        // Simple print control - content starts from top\r\n        window.addEventListener('afterprint', function() {\r\n          console.log('Barcode print completed - closing window');\r\n          setTimeout(() => window.close(), 500);\r\n        });\r\n        \r\n        // Add paper cut spacing at the end\r\n        document.addEventListener('DOMContentLoaded', function() {\r\n          const container = document.querySelector('.barcode-container');\r\n          if (container) {\r\n            const spacer = document.createElement('div');\r\n            spacer.style.height = '5mm';\r\n            spacer.style.width = '100%';\r\n            container.appendChild(spacer);\r\n          }\r\n        });\r\n        \r\n        // Simple and reliable print function\r\n        function doPrint() {\r\n          setTimeout(() => {\r\n            window.print();\r\n          }, 2000);\r\n        }\r\n        \r\n        // Wait for JsBarcode to load, then generate and print\r\n        function waitForJsBarcodeAndPrint() {\r\n          if (typeof window.JsBarcode !== 'undefined') {\r\n            generateBarcodes();\r\n            doPrint();\r\n          } else {\r\n            setTimeout(waitForJsBarcodeAndPrint, 100);\r\n          }\r\n        }\r\n        \r\n        // Start the process\r\n        if (document.readyState === 'complete') {\r\n          waitForJsBarcodeAndPrint();\r\n        } else {\r\n          window.addEventListener('load', waitForJsBarcodeAndPrint);\r\n        }\r\n        \r\n        // Fallback\r\n        setTimeout(() => {\r\n          if (typeof window.JsBarcode !== 'undefined') {\r\n            generateBarcodes();\r\n          }\r\n          doPrint();\r\n        }, 4000);\r\n      </script>\r\n    </body>\r\n    </html>\r\n  `\r\n}"],"names":[],"mappings":"kEAUiC,CAC/B,EACA,EACA,KAEA,IAAM,EAAc,EAAS,GAAG,CAAC,GAAQ,CAAC;;MAEtC,EAAE,EAAK,WAAW,CAAG,CAAC,0BAA0B,EAAE,EAAK,WAAW,CAAC,WAAW,GAAG,MAAM,CAAC,CAAG,GAAG;;qDAE/C,EAAE,EAAK,OAAO,CAAC;;kCAElC,EAAE,EAAK,OAAO,CAAC;MAC3C,EAAE,EAAK,KAAK,CAAG,CAAC,mBAAmB,EAAE,EAAY,EAAK,KAAK,EAAE,MAAM,CAAC,CAAG,GAAG;;EAE9E,CAAC,EAAE,IAAI,CAAC,IAER,MAAO,CAAC;;;;;;;;;;;;;;;;kBAgBQ,EAAkB,SAAhB,EAAyB,YAAc,YAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2BA6B5C,EAAE,AAAoB,MAAX,MAAM,CAAS,SAAW,aAAa;;;;;iBAK5D,EAAkB,SAAhB,EAAyB,OAAS,OAAO;kBAC1C,EAAkB,SAAhB,EAAyB,OAAS,OAAO;;;;;;;;;;;;;;;;;qBAiBxC,EAAkB,SAAhB,EAAyB,MAAQ,MAAM;;;;kBAI5C,EAAkB,SAAhB,EAAyB,MAAQ,MAAM;;;;;;;;;;;;;;;;;;;;;;;kBAuBzC,EAAkB,SAAhB,EAAyB,OAAS,OAAO;;;;;;;qBAOxC,EAAkB,SAAhB,EAAyB,MAAQ,OAAO;;;;;;;;;;qBAU1C,EAAkB,SAAhB,EAAyB,MAAQ,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBA8BxC,EAAkB,SAAhB,EAAyB,MAAQ,MAAM;;;;;;;;;;;;uBAYzC,EAAkB,SAAhB,EAAyB,MAAQ,OAAO;;;;;;;uBAO1C,EAAkB,SAAhB,EAAyB,MAAQ,OAAO;;;;;;;;;;QAUzD,EAAE,YAAY;;;;;;;;;;;;uBAYC,EAAkB,SAAhB,EAAyB,MAAQ,MAAM;wBACxC,EAAkB,SAAhB,EAAyB,KAAO,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA6D7D,CAAC,AACH"}