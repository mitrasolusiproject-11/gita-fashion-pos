{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///Users/alifisk/project/gita-fashion-pos/src/lib/schema.ts"],"sourcesContent":["import { sqliteTable, text, integer, real } from 'drizzle-orm/sqlite-core'\nimport { relations } from 'drizzle-orm'\n\n// Users table\nexport const users = sqliteTable('users', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  email: text('email').notNull().unique(),\n  name: text('name').notNull(),\n  password: text('password').notNull(),\n  role: text('role', { enum: ['ADMIN', 'MANAGER', 'CASHIER'] }).notNull().default('CASHIER'),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Categories table\nexport const categories = sqliteTable('categories', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  name: text('name').notNull().unique(),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Products table\nexport const products = sqliteTable('products', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  barcode: text('barcode').notNull().unique(),\n  name: text('name').notNull(),\n  categoryId: text('category_id').references(() => categories.id),\n  initialStock: integer('initial_stock').notNull().default(0),\n  currentStock: integer('current_stock').notNull().default(0),\n  sellPrice: real('sell_price').notNull(),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Transactions table\nexport const transactions = sqliteTable('transactions', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  code: text('code').notNull().unique(),\n  transactionDate: integer('transaction_date', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  totalItems: integer('total_items').notNull(),\n  cashAmount: real('cash_amount').notNull().default(0),\n  transferAmount: real('transfer_amount').notNull().default(0),\n  bankName: text('bank_name'),\n  paymentProof: text('payment_proof'),\n  paymentStatus: text('payment_status', { enum: ['PENDING', 'PAID', 'CANCELLED'] }).notNull().default('PENDING'),\n  userId: text('user_id').notNull().references(() => users.id),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Outgoing Items table\nexport const outgoingItems = sqliteTable('outgoing_items', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  date: integer('date', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  barcode: text('barcode').notNull(),\n  productName: text('product_name').notNull(),\n  quantity: integer('quantity').notNull(),\n  transactionCode: text('transaction_code').notNull().references(() => transactions.code),\n  price: real('price').notNull(),\n  discountPercent: real('discount_percent').notNull().default(0),\n  discountAmount: real('discount_amount').notNull().default(0),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Settings table\nexport const settings = sqliteTable('settings', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  key: text('key').notNull().unique(),\n  value: text('value').notNull(),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Shifts table (Tutup Kasir)\nexport const shifts = sqliteTable('shifts', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  userId: text('user_id').notNull().references(() => users.id),\n  startTime: integer('start_time', { mode: 'timestamp' }).notNull(),\n  endTime: integer('end_time', { mode: 'timestamp' }),\n  startingCash: real('starting_cash').notNull().default(0),\n  endingCash: real('ending_cash'),\n  totalSales: real('total_sales').default(0),\n  totalTransactions: integer('total_transactions').default(0),\n  totalExpenses: real('total_expenses').default(0),\n  status: text('status', { enum: ['OPEN', 'CLOSED'] }).notNull().default('OPEN'),\n  notes: text('notes'),\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Expenses table (Pengeluaran)\nexport const expenses = sqliteTable('expenses', {\n  id: text('id').primaryKey().$defaultFn(() => crypto.randomUUID()),\n  shiftId: text('shift_id').references(() => shifts.id),\n  userId: text('user_id').notNull().references(() => users.id),\n  category: text('category').notNull(), // 'OPERATIONAL', 'INVENTORY', 'MAINTENANCE', 'OTHER'\n  description: text('description').notNull(),\n  amount: real('amount').notNull(),\n  receipt: text('receipt'), // Optional receipt/proof\n  createdAt: integer('created_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n  updatedAt: integer('updated_at', { mode: 'timestamp' }).$defaultFn(() => new Date()),\n})\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  transactions: many(transactions),\n}))\n\nexport const categoriesRelations = relations(categories, ({ many }) => ({\n  products: many(products),\n}))\n\nexport const productsRelations = relations(products, ({ one, many }) => ({\n  category: one(categories, {\n    fields: [products.categoryId],\n    references: [categories.id],\n  }),\n  outgoingItems: many(outgoingItems),\n}))\n\nexport const transactionsRelations = relations(transactions, ({ one, many }) => ({\n  user: one(users, {\n    fields: [transactions.userId],\n    references: [users.id],\n  }),\n  outgoingItems: many(outgoingItems),\n}))\n\nexport const outgoingItemsRelations = relations(outgoingItems, ({ one }) => ({\n  transaction: one(transactions, {\n    fields: [outgoingItems.transactionCode],\n    references: [transactions.code],\n  }),\n  product: one(products, {\n    fields: [outgoingItems.barcode],\n    references: [products.barcode],\n  }),\n}))"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 295, "column": 0}, "map": {"version":3,"sources":["file:///Users/alifisk/project/gita-fashion-pos/src/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport { drizzle } from 'drizzle-orm/better-sqlite3'\nimport * as schema from './schema'\n\n// Get database path from environment variable or use default\nconst dbPath = process.env.DATABASE_URL?.replace('file:', '') || 'sqlite.db'\n\n// Lazy initialization - only create connection when first accessed\nlet _db: ReturnType<typeof drizzle> | null = null\n\nfunction getDb() {\n  if (!_db) {\n    const sqlite = new Database(dbPath)\n    _db = drizzle(sqlite, { schema })\n  }\n  return _db\n}\n\n// Export as a getter to ensure lazy initialization\nexport const db = new Proxy({} as ReturnType<typeof drizzle>, {\n  get(target, prop) {\n    return getDb()[prop as keyof ReturnType<typeof drizzle>]\n  }\n})\n\nexport default db"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,6DAA6D;AAC7D,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY,EAAE,QAAQ,SAAS,OAAO;AAEjE,mEAAmE;AACnE,IAAI,MAAyC;AAE7C,SAAS;IACP,IAAI,CAAC,KAAK;QACR,MAAM,SAAS,IAAI,sIAAQ,CAAC;QAC5B,MAAM,IAAA,0KAAO,EAAC,QAAQ;YAAE,QAAA;QAAO;IACjC;IACA,OAAO;AACT;AAGO,MAAM,KAAK,IAAI,MAAM,CAAC,GAAiC;IAC5D,KAAI,MAAM,EAAE,IAAI;QACd,OAAO,OAAO,CAAC,KAAyC;IAC1D;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 330, "column": 0}, "map": {"version":3,"sources":["file:///Users/alifisk/project/gita-fashion-pos/src/app/api/settings/logo/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { writeFile, unlink } from 'fs/promises'\nimport { join } from 'path'\nimport { existsSync } from 'fs'\nimport { db } from '@/lib/db'\nimport { settings } from '@/lib/schema'\nimport { eq } from 'drizzle-orm'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData()\n    const file = formData.get('logo') as File\n\n    if (!file) {\n      return NextResponse.json({ error: 'No file provided' }, { status: 400 })\n    }\n\n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      return NextResponse.json({ error: 'File must be an image' }, { status: 400 })\n    }\n\n    // Validate file size (max 2MB)\n    if (file.size > 2 * 1024 * 1024) {\n      return NextResponse.json({ error: 'File size must be less than 2MB' }, { status: 400 })\n    }\n\n    // Generate unique filename\n    const timestamp = Date.now()\n    const extension = file.name.split('.').pop()\n    const filename = `logo-${timestamp}.${extension}`\n    \n    // Save file to data/uploads directory (persistent storage)\n    const bytes = await file.arrayBuffer()\n    const buffer = Buffer.from(bytes)\n    \n    // Use different path for local vs production\n    const isProduction = process.env.NODE_ENV === 'production'\n    const uploadsDir = isProduction \n      ? join('/app/data', 'uploads')\n      : join(process.cwd(), 'data', 'uploads')\n    \n    if (!existsSync(uploadsDir)) {\n      const { mkdir } = await import('fs/promises')\n      await mkdir(uploadsDir, { recursive: true })\n    }\n    \n    const filepath = join(uploadsDir, filename)\n    await writeFile(filepath, buffer)\n\n    const logoUrl = `/api/uploads/${filename}`\n\n    // Save logo URL to database settings\n    try {\n      // Check if logo setting exists\n      const existingSetting = await db\n        .select()\n        .from(settings)\n        .where(eq(settings.key, 'logoUrl'))\n        .limit(1)\n\n      if (existingSetting.length > 0) {\n        // Update existing setting\n        await db\n          .update(settings)\n          .set({ \n            value: logoUrl,\n            updatedAt: new Date()\n          })\n          .where(eq(settings.key, 'logoUrl'))\n      } else {\n        // Insert new setting\n        await db.insert(settings).values({\n          key: 'logoUrl',\n          value: logoUrl,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        })\n      }\n\n      // Clean up old logo files (optional)\n      // You might want to implement this to avoid accumulating files\n      \n      return NextResponse.json({ \n        success: true, \n        logoUrl,\n        message: 'Logo uploaded successfully' \n      })\n\n    } catch (dbError) {\n      console.error('Database error:', dbError)\n      // Clean up uploaded file if database operation fails\n      try {\n        await unlink(filepath)\n      } catch (unlinkError) {\n        console.error('Error cleaning up file:', unlinkError)\n      }\n      return NextResponse.json({ error: 'Failed to save logo setting' }, { status: 500 })\n    }\n\n  } catch (error) {\n    console.error('Error uploading logo:', error)\n    return NextResponse.json({ error: 'Failed to upload logo' }, { status: 500 })\n  }\n}\n\nexport async function GET() {\n  try {\n    // Get current logo URL from database\n    const logoSetting = await db\n      .select()\n      .from(settings)\n      .where(eq(settings.key, 'logoUrl'))\n      .limit(1)\n\n    const logoUrl = logoSetting.length > 0 ? logoSetting[0].value : '/logo-gita-fashion.svg'\n\n    return NextResponse.json({ logoUrl })\n  } catch (error) {\n    console.error('Error fetching logo:', error)\n    return NextResponse.json({ error: 'Failed to fetch logo' }, { status: 500 })\n  }\n}\n\nexport async function DELETE() {\n  try {\n    // Reset logo to default\n    const defaultLogoUrl = '/logo-gita-fashion.svg'\n\n    // Update database setting\n    const existingSetting = await db\n      .select()\n      .from(settings)\n      .where(eq(settings.key, 'logoUrl'))\n      .limit(1)\n\n    if (existingSetting.length > 0) {\n      // Get old logo URL to potentially clean up file\n      const oldLogoUrl = existingSetting[0].value\n      \n      // Update to default\n      await db\n        .update(settings)\n        .set({ \n          value: defaultLogoUrl,\n          updatedAt: new Date()\n        })\n        .where(eq(settings.key, 'logoUrl'))\n\n      // Clean up old uploaded file (if it's not the default)\n      if (oldLogoUrl && oldLogoUrl.startsWith('/api/uploads/')) {\n        try {\n          const filename = oldLogoUrl.split('/').pop()\n          const oldFilepath = join('/app/data/uploads', filename || '')\n          if (existsSync(oldFilepath)) {\n            await unlink(oldFilepath)\n          }\n        } catch (unlinkError) {\n          console.error('Error cleaning up old logo file:', unlinkError)\n          // Don't fail the request if cleanup fails\n        }\n      }\n    } else {\n      // Insert default setting\n      await db.insert(settings).values({\n        key: 'logoUrl',\n        value: defaultLogoUrl,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      })\n    }\n\n    return NextResponse.json({ \n      success: true, \n      logoUrl: defaultLogoUrl,\n      message: 'Logo reset to default' \n    })\n\n  } catch (error) {\n    console.error('Error resetting logo:', error)\n    return NextResponse.json({ error: 'Failed to reset logo' }, { status: 500 })\n  }\n}"],"names":[],"mappings":"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","debugId":null}}]
}